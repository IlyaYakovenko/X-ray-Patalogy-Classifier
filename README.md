# X-ray-Patalogy-Classifier

**–û–ø–∏—Å–∞–Ω–∏–µ:**  
–ü—Ä–æ–µ–∫—Ç –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞—Ç–æ–ª–æ–≥–∏–π –Ω–∞ —Ä–µ–Ω—Ç–≥–µ–Ω-—Å–Ω–∏–º–∫–∞—Ö –≥—Ä—É–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ResNet-50 –∏ transfer learning ImageNet. –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç 15 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–∞—Ç–æ–ª–æ–≥–∏–π –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ—à–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é Grad-CAM.

---

## üõ† –û—Å–Ω–æ–≤–Ω—ã–µ —à–∞–≥–∏

### 1. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏—è.
- –ë–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Å–æ–≤ —á–µ—Ä–µ–∑ undersampling no findings –∏ oversampling –ø–∞—Ç–æ–ª–æ–≥–∏–π.
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä **—Å —É—á–µ—Ç–æ–º –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤**, —á—Ç–æ–±—ã –æ–¥–∏–Ω –ø–∞—Ü–∏–µ–Ω—Ç –Ω–µ –ø–æ–ø–∞–¥–∞–ª –≤ –æ–±–µ –≤—ã–±–æ—Ä–∫–∏.

### 2. –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
- Random rotation, horizontal flip, brightness/contrast adjustments.
- –£–º–µ–Ω—å—à–∞—é—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –∏ –ø–æ–≤—ã—à–∞—é—Ç –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏.

### 3. –ú–æ–¥–µ–ª—å
- ResNet-50 —Å –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–º–∏ –≤–µ—Å–∞–º–∏ ImageNet.
- –ü–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã–π —Å–ª–æ–π –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ 15 –≤—ã—Ö–æ–¥–æ–≤ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–∞—Ç–æ–ª–æ–≥–∏–π.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å **Focal Weighted Loss** –¥–ª—è –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤.

### 4. –ü–æ–¥–±–æ—Ä –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–ª–∏—Å—å: learning rate, batch size, threshold, focal alpha, focal gamma, maximum class weight.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Optuna –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.

### 5. Explainability (Grad-CAM)
- –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è, –Ω–∞ –∫–∞–∫–∏–µ –æ–±–ª–∞—Å—Ç–∏ —Å–Ω–∏–º–∫–∞ –º–æ–¥–µ–ª—å –æ–±—Ä–∞—â–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏.

![Grad-CAM Demo](outputs/figures/gradcam_demo.jpg)

### 6. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ–ª–∏

–ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ:

| –ü–∞—Ç–æ–ª–æ–≥–∏—è             | Precision | Recall | F1-score |
|-----------------------|-----------|--------|----------|
| No Findings           | 0.92      | 0.95   | 0.93     |
| Atelectasis           | 0.81      | 0.76   | 0.78     |
| Cardiomegaly          | 0.88      | 0.90   | 0.89     |
| Effusion              | 0.85      | 0.83   | 0.84     |
| Infiltration          | 0.79      | 0.75   | 0.77     |
| Mass                  | 0.82      | 0.78   | 0.80     |
| Nodule                | 0.80      | 0.77   | 0.78     |
| Pneumonia             | 0.84      | 0.80   | 0.82     |
| Pneumothorax          | 0.87      | 0.84   | 0.85     |
| Consolidation         | 0.78      | 0.74   | 0.76     |
| Edema                 | 0.86      | 0.82   | 0.84     |
| Emphysema             | 0.83      | 0.79   | 0.81     |
| Fibrosis              | 0.81      | 0.77   | 0.79     |
| Pleural Thickening    | 0.80      | 0.76   | 0.78     |
| Hernia                | 0.89      | 0.85   | 0.87     |

**–°—Ä–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:**  
- Macro F1-score: 0.82  
- Accuracy: 0.87  

---
## ‚ö° –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- Python 3.11
- PyTorch  
- Albumentations  
- OpenCV, Matplotlib  
- Optuna
---
